<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self'; script-src 'self'; img-src 'self' data:; connect-src 'self' https:" />
  <title>CertNode — Verify Receipt</title>
  <link rel="stylesheet" href="assets/certnode.css" />
</head>
<body>
  <header>
    <div class="row" style="justify-content:space-between; align-items:center; margin:0">
      <h1>CertNode — Verify Receipt</h1>
      <div class="toolbar" style="margin:0">
        <button id="theme-toggle" title="Toggle theme">Theme</button>
      </div>
    </div>
  </header>
  <a href="#main" class="skip-link">Skip to main content</a>
  <main id="main">
    <section class="panel">
      <h2>Receipt JSON</h2>
      <div class="row grid-2">
        <div class="dropzone" id="receipt-drop" role="button" tabindex="0" aria-label="Drop receipt.json here or press Enter to choose a file">Drop receipt.json here</div>
        <div class="toolbar" style="justify-content:flex-end">
          <input type="file" id="receipt-file" accept="application/json" aria-label="Choose receipt JSON file" />
          <button id="receipt-sample">Load sample</button>
          <button id="receipt-format">Format</button>
          <button id="receipt-minify">Minify</button>
        </div>
      </div>
      <textarea id="receipt" placeholder='{"protected":"...","payload":{...},"signature":"...","kid":"..."}'></textarea>
    </section>

    <section class="panel">
      <h2>JWKS</h2>
      <div class="row grid-2">
        <div class="dropzone" id="jwks-drop" role="button" tabindex="0" aria-label="Drop jwks.json here or press Enter to choose a file">Drop jwks.json here</div>
        <div class="toolbar" style="justify-content:flex-end">
          <input type="file" id="jwks-file" accept="application/json" aria-label="Choose JWKS JSON file" />
          <button id="jwks-format">Format</button>
          <button id="jwks-minify">Minify</button>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <input type="url" id="jwks-url" placeholder="Optional: https://.../.well-known/jwks.json" />
        <button id="fetch-jwks">Fetch</button>
      </div>
      <textarea id="jwks" placeholder='{"keys":[{"kty":"EC","crv":"P-256","x":"...","y":"...","kid":"..."}]}'></textarea>
      <div class="small muted">JWKS is cached locally in your browser for convenience.</div>
    </section>

    <section class="panel" style="grid-column: 1 / -1;">
      <h2>Verify</h2>
      <div class="row" style="gap:8px">
        <button id="verify">Verify</button>
        <button id="clear">Clear</button>
        <span class="small">Verification uses WebCrypto (ES256) via web/js/verify.js</span>
      </div>
      <div id="status" class="status" style="display:none" aria-live="polite"></div>
      <div style="margin-top:8px" class="grid-2">
        <div>
          <div class="row" style="justify-content:space-between; align-items:center">
            <h3 class="small" style="margin:0">Protected Header</h3>
            <button id="copy-hdr" class="pill">Copy</button>
          </div>
          <pre id="hdr"></pre>
        </div>
        <div>
          <div class="row" style="justify-content:space-between; align-items:center">
            <h3 class="small" style="margin:0">Result</h3>
            <button id="copy-result" class="pill">Copy</button>
          </div>
          <pre id="result"></pre>
        </div>
      </div>
    </section>
  </main>
  <footer>
    Paste or drop files above. For full offline verification, use the Node SDK or CLI in <code>tools/verify-receipt.js</code>.
  </footer>

  <script src="js/verify.js"></script>
  <script src="js/verify-helper.js"></script>
  <script type="module" src="js/verify-page.js"></script>
</body>
</html>
